<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Roys Vesta ‚Äî ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</title>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: sans-serif; background: #faf8f4; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">

    // ===================================================
    // ‡∏ß‡∏≤‡∏á URL ‡∏à‡∏≤‡∏Å Google Apps Script ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbwR-AXVXlNe55ArNmp1JCQSOe_RC7Tqp5woTzGKqmafFZVnxSIEEY4N5W3xB8GXoZ6SOQ/exec
    // ===================================================

    const C = {
      black: "#0a0a0a", gold: "#b5a06a", goldLight: "#8a7550",
      green: "#4e825a", white: "#ffffff", bg: "#faf8f4",
      card: "#ffffff", border: "#e8e0d0", text: "#1a1a1a", sub: "#7a7060",
    };

    const sections = [
      {
        id: "admin", icon: "üí¨", title: "‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢", subtitle: "‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤",
        questions: [
          { id: "a1", label: "‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ï‡∏≠‡∏ö‡πÑ‡∏ß ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô" },
          { id: "a2", label: "‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤" },
          { id: "a3", label: "‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏û‡∏π‡∏î‡∏à‡∏≤‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£" },
        ],
      },
      {
        id: "team", icon: "üë∑", title: "‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", subtitle: "‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û",
        questions: [
          { id: "t1", label: "‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤" },
          { id: "t2", label: "‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" },
          { id: "t3", label: "‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à" },
        ],
      },
      {
        id: "work", icon: "‚ú®", title: "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô", subtitle: "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£",
        questions: [
          { id: "w1", label: "‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô" },
          { id: "w2", label: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô" },
          { id: "w3", label: "‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á" },
        ],
      },
      {
        id: "value", icon: "üí∞", title: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤", subtitle: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö",
        questions: [
          { id: "v1", label: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö" },
          { id: "v2", label: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô / ‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à" },
        ],
      },
    ];

    function StarRating({ value, onChange }) {
      const [hover, setHover] = React.useState(0);
      const labels = ["", "‡πÅ‡∏¢‡πà", "‡∏û‡∏≠‡πÉ‡∏ä‡πâ", "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", "‡∏î‡∏µ", "‡∏î‡∏µ‡∏°‡∏≤‡∏Å"];
      const active = hover || value;
      return (
        <div style={{ display: "flex", alignItems: "center", gap: 4 }}>
          {[1,2,3,4,5].map(s => (
            <span key={s} onClick={() => onChange(s)}
              onMouseEnter={() => setHover(s)} onMouseLeave={() => setHover(0)}
              style={{ fontSize: 26, cursor: "pointer", transition: "transform 0.1s",
                transform: active >= s ? "scale(1.2)" : "scale(1)", opacity: active >= s ? 1 : 0.25 }}>‚≠ê</span>
          ))}
          {active > 0 && <span style={{ fontSize: 12, color: C.gold, fontWeight: "bold", marginLeft: 6 }}>{labels[active]}</span>}
        </div>
      );
    }

    function App() {
      const [scores, setScores] = React.useState({});
      const [service, setService] = React.useState("");
      const [comment, setComment] = React.useState("");
      const [recommend, setRecommend] = React.useState(null);
      const [submitted, setSubmitted] = React.useState(false);
      const [loading, setLoading] = React.useState(false);

      const allQs = sections.flatMap(s => s.questions);
      const answered = allQs.filter(q => scores[q.id] > 0).length;
      const total = allQs.length;
      const avg = answered > 0 ? (allQs.reduce((s, q) => s + (scores[q.id] || 0), 0) / answered).toFixed(1) : null;
      const canSubmit = answered === total && service && recommend !== null;

      const handleSubmit = async () => {
        if (!canSubmit) return;
        setLoading(true);
        try {
          await fetch(SHEET_URL, {
            method: "POST",
            body: JSON.stringify({ service, ...scores, recommend, comment }),
          });
        } catch (e) {}
        setLoading(false);
        setSubmitted(true);
      };

      if (submitted) {
        return (
          <div style={{ fontFamily: "sans-serif", minHeight: "100vh", background: C.black, display: "flex", alignItems: "center", justifyContent: "center", padding: 24 }}>
            <div style={{ background: C.white, borderRadius: 24, padding: 40, textAlign: "center", maxWidth: 380, boxShadow: "0 12px 40px rgba(0,0,0,0.4)" }}>
              <div style={{ fontSize: 60 }}>üéâ</div>
              <h2 style={{ color: C.black, margin: "12px 0 8px" }}>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö!</h2>
              <p style={{ color: C.sub, lineHeight: 1.7 }}>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤<br />‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
              <div style={{ margin: "20px 0", background: C.bg, borderRadius: 14, padding: 20, border: `2px solid ${C.border}` }}>
                <div style={{ fontSize: 40, fontWeight: "bold", color: C.gold }}>{avg} / 5</div>
                <div style={{ color: C.sub, fontSize: 13, marginTop: 4 }}>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
              </div>
              <button onClick={() => { setScores({}); setService(""); setComment(""); setRecommend(null); setSubmitted(false); }}
                style={{ background: C.black, color: C.white, border: "none", borderRadius: 12, padding: "12px 28px", cursor: "pointer", fontSize: 14, fontWeight: "bold" }}>
                ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡∏°‡πà
              </button>
            </div>
          </div>
        );
      }

      return (
        <div style={{ fontFamily: "sans-serif", minHeight: "100vh", background: C.bg, padding: "24px 16px" }}>
          <div style={{ maxWidth: 560, margin: "0 auto" }}>

            <div style={{ background: C.black, borderRadius: 20, padding: "32px 24px", textAlign: "center", marginBottom: 16 }}>
              <div style={{ display: "flex", justifyContent: "center", gap: 4, marginBottom: 12 }}>
                {["#b5a06a","#d4c9b8","#ffffff","#6a9e72"].map(c => (
                  <div key={c} style={{ width: 14, height: 14, borderRadius: "50%", background: c }} />
                ))}
              </div>
              <h1 style={{ margin: 0, fontSize: 24, color: C.white, letterSpacing: 2 }}>ROYS VESTA</h1>
              <p style={{ margin: "8px 0 0", color: "#d4c9b8", fontSize: 13, letterSpacing: 1 }}>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
              <div style={{ width: 40, height: 2, background: C.gold, margin: "16px auto 0" }} />
            </div>

            <div style={{ background: C.card, borderRadius: 14, padding: "14px 20px", marginBottom: 12, border: `1px solid ${C.border}` }}>
              <div style={{ display: "flex", justifyContent: "space-between", fontSize: 12, color: C.sub, marginBottom: 8 }}>
                <span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span>
                <span style={{ color: C.gold, fontWeight: "bold" }}>{answered}/{total} ‡∏Ç‡πâ‡∏≠</span>
              </div>
              <div style={{ background: C.border, borderRadius: 99, height: 6 }}>
                <div style={{ background: `linear-gradient(90deg, ${C.gold}, ${C.green})`, borderRadius: 99, height: 6, width: `${(answered/total)*100}%`, transition: "width 0.3s" }} />
              </div>
            </div>

            <div style={{ background: C.card, borderRadius: 16, padding: "20px 24px", marginBottom: 12, border: `1px solid ${C.border}` }}>
              <p style={{ margin: "0 0 14px", fontWeight: "bold", color: C.text, fontSize: 14 }}>üõ†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£? <span style={{ color: C.green }}>*</span></p>
              <div style={{ display: "flex", gap: 10, flexWrap: "wrap" }}>
                {[["üßπ","‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô"],["‚ùÑÔ∏è","‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏£‡πå"],["üßπ‚ùÑÔ∏è","‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á"]].map(([icon, label]) => (
                  <button key={label} onClick={() => setService(label)} style={{
                    flex: 1, minWidth: 100, padding: "12px 8px", borderRadius: 12, cursor: "pointer", fontSize: 13, fontWeight: "bold",
                    border: service === label ? `2px solid ${C.gold}` : `2px solid ${C.border}`,
                    background: service === label ? "#f5f0e8" : C.bg,
                    color: service === label ? C.gold : C.sub, transition: "all 0.2s",
                  }}>{icon} {label}</button>
                ))}
              </div>
            </div>

            {sections.map(sec => (
              <div key={sec.id} style={{ background: C.card, borderRadius: 16, padding: "20px 24px", marginBottom: 12, border: `1px solid ${C.border}` }}>
                <div style={{ marginBottom: 16, paddingBottom: 12, borderBottom: `1px solid ${C.border}` }}>
                  <span style={{ fontSize: 20 }}>{sec.icon}</span>
                  <span style={{ fontWeight: "bold", color: C.gold, fontSize: 15, marginLeft: 8 }}>{sec.title}</span>
                  <p style={{ margin: "4px 0 0 28px", fontSize: 12, color: C.sub }}>{sec.subtitle}</p>
                </div>
                {sec.questions.map(q => (
                  <div key={q.id} style={{ marginBottom: 18 }}>
                    <p style={{ margin: "0 0 8px", fontSize: 14, color: C.text }}>{q.label}</p>
                    <StarRating value={scores[q.id] || 0} onChange={v => setScores(prev => ({ ...prev, [q.id]: v }))} />
                  </div>
                ))}
              </div>
            ))}

            <div style={{ background: C.card, borderRadius: 16, padding: "20px 24px", marginBottom: 12, border: `1px solid ${C.border}` }}>
              <p style={{ margin: "0 0 14px", fontWeight: "bold", color: C.text, fontSize: 14 }}>ü§ù ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Roys Vesta ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏°? <span style={{ color: C.green }}>*</span></p>
              <div style={{ display: "flex", gap: 10 }}>
                {[["üëç","‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",true],["ü§î","‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à","maybe"],["üëé","‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",false]].map(([icon, label, val]) => (
                  <button key={label} onClick={() => setRecommend(val)} style={{
                    flex: 1, padding: "12px 8px", borderRadius: 12, cursor: "pointer", fontSize: 13, fontWeight: "bold",
                    border: recommend === val ? `2px solid ${C.green}` : `2px solid ${C.border}`,
                    background: recommend === val ? "#eef4ef" : C.bg,
                    color: recommend === val ? C.green : C.sub, transition: "all 0.2s",
                  }}>{icon} {label}</button>
                ))}
              </div>
            </div>

            <div style={{ background: C.card, borderRadius: 16, padding: "20px 24px", marginBottom: 16, border: `1px solid ${C.border}` }}>
              <p style={{ margin: "0 0 10px", fontWeight: "bold", color: C.text, fontSize: 14 }}>üí° ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</p>
              <textarea value={comment} onChange={e => setComment(e.target.value)}
                placeholder="‡∏ö‡∏≠‡∏Å‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏∞‡πÑ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô..."
                rows={3} style={{
                  width: "100%", borderRadius: 10, border: `1.5px solid ${C.border}`, padding: "10px 12px",
                  fontSize: 13, resize: "none", outline: "none", fontFamily: "sans-serif",
                  background: C.bg, color: C.text,
                }} />
            </div>

            <button onClick={handleSubmit} disabled={!canSubmit || loading} style={{
              width: "100%", padding: "16px", borderRadius: 14, border: "none",
              cursor: canSubmit ? "pointer" : "not-allowed",
              background: canSubmit ? `linear-gradient(135deg, ${C.gold}, ${C.green})` : "#ddd",
              color: canSubmit ? C.black : "#999", fontSize: 15, fontWeight: "bold",
              marginBottom: 32, letterSpacing: 1, transition: "all 0.3s",
            }}>
              {loading ? "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á..." : canSubmit ? "‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°" : `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö (${answered}/${total} ‡∏Ç‡πâ‡∏≠)`}
            </button>

          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Roys Vesta ‚Äî ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: sans-serif; background: #faf8f4; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">

    const SHEET_URL = "https://script.google.com/macros/s/AKfycbwR-AXVXlNe55ArNmp1JCQSOe_RC7Tqp5woTzGKqmafFZVnxSIEEY4N5W3xB8GXoZ6SOQ/exec";

    const sections = [
      { id:"admin", icon:"üí¨", title:"‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢", sub:"‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤", qs:[
        {id:"a1",label:"‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ï‡∏≠‡∏ö‡πÑ‡∏ß ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô"},
        {id:"a2",label:"‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤"},
        {id:"a3",label:"‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏û‡∏π‡∏î‡∏à‡∏≤‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£"}]},
      { id:"team", icon:"üë∑", title:"‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", sub:"‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û", qs:[
        {id:"t1",label:"‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤"},
        {id:"t2",label:"‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"},
        {id:"t3",label:"‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à"}]},
      { id:"work", icon:"‚ú®", title:"‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô", sub:"‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", qs:[
        {id:"w1",label:"‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô"},
        {id:"w2",label:"‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô"},
        {id:"w3",label:"‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á"}]},
      { id:"value", icon:"üí∞", title:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤", sub:"‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö", qs:[
        {id:"v1",label:"‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö"},
        {id:"v2",label:"‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô / ‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à"}]}
    ];

    const starLabels = ["","‡πÅ‡∏¢‡πà","‡∏û‡∏≠‡πÉ‡∏ä‡πâ","‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á","‡∏î‡∏µ","‡∏î‡∏µ‡∏°‡∏≤‡∏Å"];
    let scores = {}, service = "", comment = "", recommend = null;

    function getAnswered() {
      return sections.flatMap(s=>s.qs).filter(q=>scores[q.id]>0).length;
    }
    function getTotal() {
      return sections.flatMap(s=>s.qs).length;
    }
    function getAvg() {
      const qs = sections.flatMap(s=>s.qs);
      const ans = qs.filter(q=>scores[q.id]>0);
      if (!ans.length) return 0;
      return (ans.reduce((s,q)=>s+(scores[q.id]||0),0)/ans.length).toFixed(1);
    }

    function render() {
      const answered = getAnswered();
      const total = getTotal();
      const canSubmit = answered === total && service && recommend !== null;

      let html = `<div class="wrap">
        <div class="header">
          <div class="dots">
            <div class="dot" style="background:#b5a06a"></div>
            <div class="dot" style="background:#d4c9b8"></div>
            <div class="dot" style="background:#fff"></div>
            <div class="dot" style="background:#6a9e72"></div>
          </div>
          <h1>ROYS VESTA</h1>
          <p>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
          <div class="divider"></div>
        </div>

        <div class="card">
          <div class="progress-label"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span><span class="progress-count">${answered}/${total} ‡∏Ç‡πâ‡∏≠</span></div>
          <div class="progress-bar-bg"><div class="progress-bar" style="width:${(answered/total)*100}%"></div></div>
        </div>

        <div class="card">
          <div class="card-label">üõ†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£? <span class="required">*</span></div>
          <div class="btn-group">
            ${["‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô","‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏£‡πå","‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á"].map(s=>`
              <button class="btn-option ${service===s?'selected-gold':''}" onclick="setService('${s}')">${s==='‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô'?'üßπ':s==='‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏£‡πå'?'‚ùÑÔ∏è':'üßπ‚ùÑÔ∏è'} ${s}</button>
            `).join('')}
          </div>
        </div>`;

      sections.forEach(sec => {
        html += `<div class="card">
          <div class="section-header">
            <span>${sec.icon}</span><span class="section-title">${sec.title}</span>
            <div class="section-sub">${sec.sub}</div>
          </div>`;
        sec.qs.forEach(q => {
          const val = scores[q.id]||0;
          html += `<div class="question">
            <p>${q.label}</p>
            <div class="stars">
              ${[1,2,3,4,5].map(s=>`<span class="star ${val>=s?'active':''}" onclick="setStar('${q.id}',${s})">‚≠ê</span>`).join('')}
              ${val>0?`<span class="star-label">${starLabels[val]}</span>`:''}
            </div>
          </div>`;
        });
        html += `</div>`;
      });

      html += `<div class="card">
          <div class="card-label">ü§ù ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Roys Vesta ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏°? <span class="required">*</span></div>
          <div class="btn-group">
            <button class="btn-option ${recommend===true?'selected-green':''}" onclick="setRecommend(true)">üëç ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
            <button class="btn-option ${recommend==='maybe'?'selected-green':''}" onclick="setRecommend('maybe')">ü§î ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à</button>
            <button class="btn-option ${recommend===false?'selected-green':''}" onclick="setRecommend(false)">üëé ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
          </div>
        </div>

        <div class="card">
          <div class="card-label">üí° ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</div>
          <textarea rows="3" placeholder="‡∏ö‡∏≠‡∏Å‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏∞‡πÑ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô..." oninput="setComment(this.value)">${comment}</textarea>
        </div>

        <button class="btn-submit ${canSubmit?'ready':'disabled'}" onclick="submitForm()">
          ${canSubmit ? '‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°' : '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ('+answered+'/'+total+' ‡∏Ç‡πâ‡∏≠)'}
        </button>
      </div>`;

      document.getElementById('app').innerHTML = html;
    }

    function renderThank() {
      document.getElementById('app').innerHTML = `
        <div class="thank-wrap">
          <div class="thank-card">
            <div style="font-size:60px">üéâ</div>
            <h2>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö!</h2>
            <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤<br>‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
            <div class="score-box">
              <div class="score-num">${getAvg()} / 5</div>
              <div class="score-sub">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
            </div>
            <button class="btn-reset" onclick="resetForm()">‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡∏°‡πà</button>
          </div>
        </div>`;
    }

    function setService(v) { service = v; render(); }
    function setStar(id, v) { scores[id] = v; render(); }
    function setRecommend(v) { recommend = v; render(); }
    function setComment(v) { comment = v; }

    async function submitForm() {
      const answered = getAnswered();
      const total = getTotal();
      if (answered !== total || !service || recommend === null) return;
      try {
        await fetch(SHEET_URL, {
          method: "POST",
          body: JSON.stringify({ service, ...scores, recommend, comment })
        });
      } catch(e) {}
      renderThank();
    }

    function resetForm() {
      scores = {}; service = ""; comment = ""; recommend = null;
      render();
    }

    render();
  </script>
</body>
</html>

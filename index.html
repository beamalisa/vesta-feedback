<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Roys Vesta ‚Äî ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: sans-serif; background: #faf8f4; }
    .wrap { max-width: 560px; margin: 0 auto; padding: 24px 16px; }
    .header { background: #0a0a0a; border-radius: 20px; padding: 32px 24px; text-align: center; margin-bottom: 16px; }
    .header h1 { color: #fff; font-size: 24px; letter-spacing: 2px; margin: 12px 0 8px; }
    .header p { color: #d4c9b8; font-size: 13px; letter-spacing: 1px; }
    .divider { width: 40px; height: 2px; background: #b5a06a; margin: 16px auto 0; }
    .dots { display: flex; justify-content: center; gap: 4px; }
    .dot { width: 14px; height: 14px; border-radius: 50%; }
    .card { background: #fff; border-radius: 16px; padding: 20px 24px; margin-bottom: 12px; border: 1px solid #e8e0d0; }
    .progress-bar-bg { background: #e8e0d0; border-radius: 99px; height: 6px; }
    .progress-bar { background: linear-gradient(90deg, #b5a06a, #4e825a); border-radius: 99px; height: 6px; transition: width 0.3s; }
    .progress-label { display: flex; justify-content: space-between; font-size: 12px; color: #7a7060; margin-bottom: 8px; }
    .progress-count { color: #b5a06a; font-weight: bold; }
    .section-title { font-weight: bold; color: #b5a06a; font-size: 15px; margin-left: 8px; }
    .section-sub { font-size: 12px; color: #7a7060; margin: 4px 0 0 28px; }
    .section-header { padding-bottom: 12px; border-bottom: 1px solid #e8e0d0; margin-bottom: 16px; }
    .question { margin-bottom: 18px; }
    .question p { font-size: 14px; color: #1a1a1a; margin-bottom: 8px; }
    .stars { display: flex; align-items: center; gap: 4px; }
    .star { font-size: 26px; cursor: pointer; transition: transform 0.1s; opacity: 0.25; }
    .star.active { opacity: 1; transform: scale(1.2); }
    .star-label { font-size: 12px; color: #b5a06a; font-weight: bold; margin-left: 6px; }
    .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }
    .btn-option { flex: 1; min-width: 100px; padding: 12px 8px; border-radius: 12px; cursor: pointer; font-size: 13px; font-weight: bold; border: 2px solid #e8e0d0; background: #faf8f4; color: #7a7060; transition: all 0.2s; }
    .btn-option.selected-gold { border-color: #b5a06a; background: #f5f0e8; color: #b5a06a; }
    .btn-option.selected-green { border-color: #4e825a; background: #eef4ef; color: #4e825a; }
    textarea { width: 100%; border-radius: 10px; border: 1.5px solid #e8e0d0; padding: 10px 12px; font-size: 13px; resize: none; outline: none; font-family: sans-serif; background: #faf8f4; color: #1a1a1a; }
    .btn-submit { width: 100%; padding: 16px; border-radius: 14px; border: none; font-size: 15px; font-weight: bold; margin-bottom: 32px; letter-spacing: 1px; transition: all 0.3s; cursor: pointer; }
    .btn-submit.ready { background: linear-gradient(135deg, #b5a06a, #4e825a); color: #0a0a0a; }
    .btn-submit.disabled { background: #ddd; color: #999; cursor: not-allowed; }
    .card-label { font-weight: bold; color: #1a1a1a; font-size: 14px; margin-bottom: 14px; }
    .required { color: #4e825a; }
    .thank-wrap { min-height: 100vh; background: #0a0a0a; display: flex; align-items: center; justify-content: center; padding: 24px; }
    .thank-card { background: #fff; border-radius: 24px; padding: 40px; text-align: center; max-width: 380px; }
    .thank-card h2 { color: #0a0a0a; margin: 12px 0 8px; }
    .thank-card p { color: #7a7060; line-height: 1.7; }
    .score-box { margin: 20px 0; background: #faf8f4; border-radius: 14px; padding: 20px; border: 2px solid #e8e0d0; }
    .score-num { font-size: 40px; font-weight: bold; color: #b5a06a; }
    .score-sub { color: #7a7060; font-size: 13px; margin-top: 4px; }
    .btn-reset { background: #0a0a0a; color: #fff; border: none; border-radius: 12px; padding: 12px 28px; cursor: pointer; font-size: 14px; font-weight: bold; }
  </style>
</head>
<body>
  <div id="app"></div>
  <script>
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbwR-AXVXlNe55ArNmp1JCQSOe_RC7Tqp5woTzGKqmafFZVnxSIEEY4N5W3xB8GXoZ6SOQ/exec";

    const sections = [
      { id:"admin", icon:"üí¨", title:"‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢", sub:"‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤", qs:[
        {id:"a1",label:"‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ï‡∏≠‡∏ö‡πÑ‡∏ß ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô"},
        {id:"a2",label:"‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤"},
        {id:"a3",label:"‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏û‡∏π‡∏î‡∏à‡∏≤‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£"}]},
      { id:"team", icon:"üë∑", title:"‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", sub:"‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û", qs:[
        {id:"t1",label:"‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤"},
        {id:"t2",label:"‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"},
        {id:"t3",label:"‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à"}]},
      { id:"work", icon:"‚ú®", title:"‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô", sub:"‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", qs:[
        {id:"w1",label:"‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô"},
        {id:"w2",label:"‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô"},
        {id:"w3",label:"‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á"}]},
      { id:"value", icon:"üí∞", title:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤", sub:"‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö", qs:[
        {id:"v1",label:"‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö"},
        {id:"v2",label:"‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô / ‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à"}]}
    ];

    const starLabels = ["","‡πÅ‡∏¢‡πà","‡∏û‡∏≠‡πÉ‡∏ä‡πâ","‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á","‡∏î‡∏µ","‡∏î‡∏µ‡∏°‡∏≤‡∏Å"];
    let scores = {}, service = "", comment = "", recommend = null;

    function getAnswered() {
      return sections.flatMap(s=>s.qs).filter(q=>scores[q.id]>0).length;
    }
    function getTotal() {
      return sections.flatMap(s=>s.qs).length;
    }
    function getAvg() {
      const qs = sections.flatMap(s=>s.qs);
      const ans = qs.filter(q=>scores[q.id]>0);
      if (!ans.length) return 0;
      return (ans.reduce((s,q)=>s+(scores[q.id]||0),0)/ans.length).toFixed(1);
    }

    let customerName = "", location = "";

    function render() {
      const answered = getAnswered();
      const total = getTotal();
      const canSubmit = answered === total && service && recommend !== null && customerName.trim() !== "" && location.trim() !== "";

      let html = `<div class="wrap">
        <div class="header">
          <div class="dots">
            <div class="dot" style="background:#b5a06a"></div>
            <div class="dot" style="background:#d4c9b8"></div>
            <div class="dot" style="background:#fff"></div>
            <div class="dot" style="background:#6a9e72"></div>
          </div>
          <h1>ROYS VESTA</h1>
          <p>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
          <div class="divider"></div>
        </div>
        <div class="card">
          <div class="progress-label"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span><span class="progress-count">${answered}/${total} ‡∏Ç‡πâ‡∏≠</span></div>
          <div class="progress-bar-bg"><div class="progress-bar" style="width:${(answered/total)*100}%"></div></div>
        </div>
        <div class="card">
          <div class="card-label">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì <span class="required">*</span></div>
          <input type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•..." value="${customerName}" oninput="setName(this.value)"
            style="width:100%;border-radius:10px;border:1.5px solid #e8e0d0;padding:10px 12px;font-size:13px;outline:none;font-family:sans-serif;background:#faf8f4;color:#1a1a1a;" />
        </div>
        <div class="card">
          <div class="card-label">üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ <span class="required">*</span></div>
          <input type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢, ‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®..." value="${location}" oninput="setLocation(this.value)"
            style="width:100%;border-radius:10px;border:1.5px solid #e8e0d0;padding:10px 12px;font-size:13px;outline:none;font-family:sans-serif;background:#faf8f4;color:#1a1a1a;" />
        </div>
        <div class="card">
          <div class="card-label">üõ†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£? <span class="required">*</span></div>
          <div class="btn-group">
            ${["‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô","‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏£‡πå","‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á"].map(s=>`
              <button class="btn-option ${service===s?'selected-gold':''}" onclick="setService('${s}')">${s==='‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô'?'üßπ':s==='‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏£‡πå'?'‚ùÑÔ∏è':'üßπ‚ùÑÔ∏è'} ${s}</button>
            `).join('')}
          </div>
        </div>`;

      sections.forEach(sec => {
        html += `<div class="card">
          <div class="section-header">
            <span>${sec.icon}</span><span class="section-title">${sec.title}</span>
            <div class="section-sub">${sec.sub}</div>
          </div>`;
        sec.qs.forEach(q => {
          const val = scores[q.id]||0;
          html += `<div class="question">
            <p>${q.label}</p>
            <div class="stars">
              ${[1,2,3,4,5].map(s=>`<span class="star ${val>=s?'active':''}" onclick="setStar('${q.id}',${s})">‚≠ê</span>`).join('')}
              ${val>0?`<span class="star-label">${starLabels[val]}</span>`:''}
            </div>
          </div>`;
        });
        html += `</div>`;
      });

      html += `<div class="card">
          <div class="card-label">ü§ù ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Roys Vesta ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏°? <span class="required">*</span></div>
          <div class="btn-group">
            <button class="btn-option ${recommend===true?'selected-green':''}" onclick="setRecommend(true)">üëç ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
            <button class="btn-option ${recommend==='maybe'?'selected-green':''}" onclick="setRecommend('maybe')">ü§î ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à</button>
            <button class="btn-option ${recommend===false?'selected-green':''}" onclick="setRecommend(false)">üëé ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
          </div>
        </div>
        <div class="card">
          <div class="card-label">üí° ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</div>
          <textarea rows="3" placeholder="‡∏ö‡∏≠‡∏Å‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏∞‡πÑ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô..." oninput="setComment(this.value)"></textarea>
        </div>
        <button class="btn-submit ${canSubmit?'ready':'disabled'}" onclick="submitForm()">
          ${canSubmit ? '‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°' : '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ('+answered+'/'+total+' ‡∏Ç‡πâ‡∏≠)'}
        </button>
      </div>`;

      document.getElementById('app').innerHTML = html;
    }

    function renderThank() {
      document.getElementById('app').innerHTML = `
        <div class="thank-wrap">
          <div class="thank-card">
            <div style="font-size:60px">üéâ</div>
            <h2>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö!</h2>
            <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤<br>‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
            <div class="score-box">
              <div class="score-num">${getAvg()} / 5</div>
              <div class="score-sub">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
            </div>
            <button class="btn-reset" onclick="resetForm()">‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡∏°‡πà</button>
          </div>
        </div>`;
    }

    function setName(v) { customerName = v; render(); }
    function setLocation(v) { location = v; render(); }
    function setService(v) { service = v; render(); }
    function setStar(id, v) { scores[id] = v; render(); }
    function setRecommend(v) { recommend = v; render(); }
    function setComment(v) { comment = v; }

    async function submitForm() {
      const answered = getAnswered();
      const total = getTotal();
      if (answered !== total || !service || recommend === null) return;
      try {
        await fetch(SHEET_URL, {
          method: "POST",
          body: JSON.stringify({ customerName, location, service, ...scores, recommend, comment })
        });
      } catch(e) {}
      renderThank();
    }

    function resetForm() {
      scores = {}; service = ""; comment = ""; recommend = null; customerName = ""; location = "";
      render();
    }

    render();
  </script>
</body>
</html>
